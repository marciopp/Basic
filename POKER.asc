10 'POKER:BY MARCIO-MMM PROG. MSX
20 COLOR13,1,1:SCREEN2:OPEN"GRP:"AS#1:KEYOFF:DEFINTA-Z:DEFUSR0=&H41:DEFUSR1=&H44:PRINTUSR0(0):COLOR15,1:PRESET(0,24):PRINT#1," MMM PROGRAMAS MSX APRESENTA : "
30 COLOR13,1:PRESET(0,48)
40 PRINT#1,"XWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWYVXWWWY XWWWY XWYXWYXWWWY XWWWWYVVV XYV V XYV V VV VV XW[ V XY VVVV Z[V V VVV V Z[X[V ZY  V Z[ VV";
50 PRINT#1,"VV XW[ V VVV V XYV V X[  V XYX[VVV V   V Z[V V VVZYV ZWY V VVZYVVZW[   ZWWW[ ZW[ZW[ZWWW[ ZW[ZW[VZWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW[";
60 PAINT(24,64):PAINT(64,64):PAINT(114,64):PAINT(164,64):PAINT(204,64)
110 PRINTUSR1(0):PRESET(0,160):COLORA,1:PRINT#1,"   Qualquer tecla para jogar   ":A$=INKEY$:IFA$<>""THEN130
120 IFA=15THENA=2:GOTO110ELSEA=A+1:GOTO110
130 CLS:PRESET(10,10):COLOR2:PRINT#1,"Quer instrucoes ?(s/n)"
131 GOSUB60000:IFW$="S"ORW$="s"THEN1000ELSEIFW$="N"ORW$="n"THEN2000ELSE131
1000 CLS:PRESET(100,10):PRINT#1,"POKER"
1010 PRESET(10,32):PRINT#1,"SEQUENCIA DECRESCENTE DE JOGOS "
1020 PRESET(10,48):PRINT#1,"1œ ROYAL STRAIGHT FLUSH        "
1030 PRESET(10,56):PRINT#1,"2œ STRAIGHT FLUSH              "
1040 PRESET(10,64):PRINT#1,"3œ QUADRA                      "
1050 PRESET(10,72):PRINT#1,"4œ FLUSH                       "
1060 PRESET(10,80):PRINT#1,"5œ FULL HAND                   "
1070 PRESET(10,88):PRINT#1,"6œ STRAIGHT(SEQUENCIA)         "
1075 PRESET(10,96):PRINT#1,"7œ TRINCA                      "
1080 PRESET(10,104):PRINT#1,"8œ DUAS DUPLAS                 "
1090 PRESET(10,112):PRINT#1,"9œ DUPLA                       "
1100 PRESET(10,128):PRINT#1,"CARTAS:A K Q J 10 9 8 7 6      "
1110 PRESET(10,160):PRINT#1,"Qualquer tecla para continuar  ":W$=INPUT$(1)
1120 CLS:PRESET(100,10):PRINT#1,"POKER"
1130 PRESET(10,32):PRINT#1,"DURANTE O JOGO                 "
1140 PRESET(10,48):PRINT#1,"F1œ DESISTENCIA                "
1150 PRESET(10,56):PRINT#1,"F2œ PAGAR PARA VER             "
1160 PRESET(10,72):PRINT#1,"APOSTE COM <NUMEROS> E <RETURN>"
1168 PRESET(0,160):PRINT#1,"   Qualquer tecla para jogar   "
1169 A=2
1170 PRESET(0,110):COLORA,1:PRINT#1,"          BOA  SORTE           ":W$=INKEY$:IFW$<>""THEN2000
1180 IFA=15THENA=2:GOTO1170ELSEA=A+1:GOTO1170
2000 CLOSE:SCREEN1:KEYOFF:WIDTH32:COLOR15,1,1:CLEAR2000:DEFINTA-Z
2001 DIMEC(10),EN(10),NA$(3),EN$(10),EC$(10),V(5),JG$(10)
2005 RESTORE55000:FORC=1TO10:READA$:JG$(C)=A$:NEXT
2050 GOSUB59000
2100 I$="XWWWWY"
2110 M$="V◊◊◊◊V"
2120 B$="ZWWWW["
2121 C$="060708091011121314"
2122 O$="060708091011121314"
2123 P$="060708091011121314"
2124 E$="060708091011121314"
2125 CO$="í€é€ê€ë€èâà€ç€å€ã€ä"
2126 OU$="ì€ö€ú€ù€õïî€ô€ò€ó€ñ"
2127 PA$="´€¶€©€™€®°†€•€§€£€¢"
2128 ES$="¨€≥€µ€∂€¥Æ≠€≤€±€∞€Ø"
2130 NA$(0)="í":NA$(1)="ì":NA$(2)="´":NA$(3)="¨"
2200 IZ=1:CZ=26:ST=6:CW=8:GOSUB6500
2205 IZ=1:CZ=26:ST=6:CW=15:GOSUB6500
2210 N=1:FORC=3TO28STEP6:LOCATEC,22:PRINTN:N=N+1:NEXT
2220 GOSUB5000
2230 LOCATE1,0:PRINT"Eu e voce temos Cz$ 1000":CO=1000:EU=1000
2240 GOSUB8000:GOSUB6000:GOSUB60000:GOSUB5000:GOSUB7000
2280 LOCATE1,1:PRINT"Suas cartas sao:"
2285 GOSUB17000:GOSUB17500
2292 FORC=1TO10:GOSUB10500:EN(C)=NA:ONNA+1GOSUB22900,22910,22920,22930:NEXT
2300 GOSUB19000:NI=1:FI=5:MW=16:H=0:GOSUB20000
2310 GOSUB22000:GOSUB23000:GOSUB19000:NI=1:FI=5:MW=16:H=0:GOSUB20000
2315 GOSUB5000:LOCATE1,1:PRINT"Aguarde minhas trocas..."
2320 NI=1:FI=5:GOSUB11000:JE=JG:GOSUB12000
2330 GOSUB5000:LOCATE1,1:PRINT"Troquei";CA;"cartas"
2340 QU=10:GOSUB14000:LOCATE1:PRINT"Eu tenho: ";JG$(JT):QU=0:GOSUB14000:LOCATE1:PRINT"Voce tem: ";JG$(JT)
4999 NI=1:FI=5:MW=9:H=5:GOSUB20000:Q$=INPUT$(1):GOTO2100
5000 FORC=0TO4:LOCATE1,C:PRINT"                               ":NEXT:RETURN
6000 LOCATE1,5:PRINT"VoceWœ";EU:LOCATE16,5:PRINT"EuWœ";CO:RETURN
6500 FORC=IZTOCZSTEPST:LOCATEC,CW:PRINTI$:FORCC=CW+1TOCW+5:LOCATEC,CC:PRINTM$:NEXT:LOCATEC,CC:PRINTB$:SOUND7,55:SOUND8,16:SOUND12,5:SOUND13,0:NEXT:RETURN
7000 AP=AP+100:EU=EU-50:CO=CO-50:GOSUB6000:GOSUB8000:RETURN
8000 LOCATE1,6:PRINT"ApostadoWœ";AP:RETURN
10000 NO=RND(-TIME)*F1:RETURN
10500 NA=RND(-TIME)*4:RETURN
11000 JG=0:MX=0:FL=0:SQ=0:FORC=NITOFI-1:FORC1=C+1TOFI:IFEC(C)=EC(C1)THENJG=JG+10
11001 NEXT:NEXT
11005 IFJG<>0THENRETURN
11010 A=0:FORC=NI+1TOFI:IFEN(NI)=EN(C)THENA=A+1:NEXTELSEC=FI:A=0:NEXT
11011 IFA=4THENFL=50
11012 A=0:FORC=NITOFI:IFEC(C)>ATHENA=EC(C):NEXTELSENEXT
11013 A1=A-4:FORC=NITOFI:FORC1=NITOFI:IFEC(C1)=A-1THENA=A-1:C1=FI:NEXTELSENEXT
11014 NEXT:IFA=A1THENSQ=35
11020 FORC=1TO5:IFEC(C)=14THENMX=15:NEXTELSENEXT
11030 JG=SQ+FL:IFJG=85THENJG=JG+MX
11040 RETURN
12000 NI=6:FI=10:GOSUB11000:JC=JG
12010 IFJC>35THENCA=0:RETURNELSEFORC=1TO5:JG(C)=0:NEXT
12020 FORC=6TO10:FORC1=6TO10:IFEC(C)=EC(C1)ANDC<>C1THENJG(C-5)=10:JG(C1-5)=10:NEXTELSENEXT
12030 NEXT
12032 CA=0:FORC=6TO10:IFJG(C-5)=10THENNEXTELSE12050
12041 RETURN
12050 GOSUB10500:EN(C)=NA:ONNA+1GOSUB22900,22910,22920,22930:CA=CA+1:NEXT:RETURN
14000 IFQU=10THENKK=JCELSEKK=JE
14010 IFKK=100THENJT=10ELSEIFKK=85THENJT=9ELSEIFKK=60THENJT=8ELSEIFKK=50THENJT=7ELSEIFKK=40THENJT=6ELSEIFKK=35THENJT=5ELSEIFKK=30THENJT=4ELSEIFKK=20THENJT=3ELSEIFKK=10THENJT=2ELSEJT=1
14020 RETURN
17000 FORC=1TO10:EC(C)=0:EN(C)=0:NEXT:RETURN
17500 FORC=1TO5:V(C)=1:NEXT:RETURN
19000 FORC=1TO10:IFEN(C)=0THEN19001ELSEIFEN(C)=1THEN19002ELSEIFEN(C)=2THEN19003ELSEEC$(C)=MID$(PA$,18-((EC(C)-6)*2),2):EN$(C)=NA$(3):NEXT:RETURN
19001 EC$(C)=MID$(CO$,18-((EC(C)-6)*2),2):EN$(C)=NA$(0):NEXT:RETURN
19002 EC$(C)=MID$(OU$,18-((EC(C)-6)*2),2):EN$(C)=NA$(1):NEXT:RETURN
19003 EC$(C)=MID$(PA$,18-((EC(C)-6)*2),2):EN$(C)=NA$(2):NEXT:RETURN
20000 FORC=NITOFI:I=C+H:LI=2+(6*(C-1)):LOCATELI,(MW):PRINT"€€€€":LOCATELI,(MW+1):PRINT"€"+EC$(I)+"€":LOCATELI,(MW+2):PRINT"€"+EN$(I)+"€€":LOCATELI,(MW+3):PRINT"€€"+EN$(I)+"€":LOCATELI,(MW+4):PRINT"€€€€":SOUND7,55:SOUND8,16:SOUND12,5:SOUND13,0:NEXT:RETURN
21000 FORC=6TO10:LI=2+(6*(C-6)):LOCATELI,9:PRINT"€€€€":LOCATELI,10:PRINT"€"+EC$(C)+"€":LOCATELI,11:PRINT"€"+EN$(C)+"€€":LOCATELI,12:PRINT"€€"+EN$(C)+"€":LOCATELI,13:PRINT"€€€€":NEXT:RETURN
22000 A=0:GOSUB5000
22009 LOCATE1,1:PRINT"Cartas?-No final aperte RETURN"
22010 GOSUB60000:R$=W$:IFR$=CHR$(13)THENGOSUB5000:LOCATE1,1:PRINT"Selecionando cartas...":RETURNELSEIFVAL(R$)<1ORVAL(R$)>5THEN22010ELSER=VAL(R$)
22020 IFV(R)=-1THENNI=R:FI=NI:MW=16:H=0:A=A-1:GOSUB20000ELSEA=A+1:IFA>=5THENA=4:GOTO22050ELSEIZ=1+(6*(R-1)):CZ=IZ:ST=1:CW=15:GOSUB6500
22025 V(R)=-V(R)
22030 GOTO22010
22050 GOSUB5000:BEEP:BEEP:BEEP:LOCATE1,0:PRINT"Troco no maximo quatro!!":GOSUB60000:GOTO22009
22900 F1=LEN(C$)/2:IFF1=0THENEN(C)=1:GOTO22910ELSEGOSUB10000:EC(C)=VAL(MID$(C$,NO*2+1,2)):C$=MID$(C$,1,NO*2)+MID$(C$,NO*2+3,F1*2):RETURN
22910 F1=LEN(O$)/2:IFF1=0THENEN(C)=2:GOTO22920ELSEGOSUB10000:EC(C)=VAL(MID$(O$,NO*2+1,2)):O$=MID$(O$,1,NO*2)+MID$(O$,NO*2+3,F1*2):RETURN
22920 F1=LEN(P$)/2:IFF1=0THENEN(C)=3:GOTO22930ELSEGOSUB10000:EC(C)=VAL(MID$(P$,NO*2+1,2)):P$=MID$(P$,1,NO*2)+MID$(P$,NO*2+3,F1*2):RETURN
22930 F1=LEN(E$)/2:IFF1=0THENEN(C)=0:GOTO22900ELSEGOSUB10000:EC(C)=VAL(MID$(E$,NO*2+1,2)):E$=MID$(E$,1,NO*2)+MID$(E$,NO*2+3,F1*2):RETURN
23000 FORC=1TO5:IFV(C)=1THENNEXT:RETURN
23020 GOSUB10500:EN(C)=NA:ONNA+1GOSUB22900,22910,22920,22930:NEXT
23030 RETURN
49999 DATA16,1088,384,32,1104,432,8,1136,520,16,1144,592,8,1160,648,16,1168,24,16,1184,384,32,1200,432,8,1232,520,16,1240,592,8,1256,648
50000 DATA16,1280,384,32,1296,432,8,1328,520,16,1344,592,8,1360,648,16,1368,40,16,1384,384,32,1400,432,8,1432,520,16,1440,592,8,1456,648
55000 DATA "Nadinha...","Dupla","Duas Duplas","Trinca","Sequencia","Full Hand","Flush","Quadra!","Straight Flush !!","ROYAL STRAIGHT FLUSH !!!!"
59000 RESTORE49999:FORCC=0TO21:READX,Y,Z:FORC=0TOX:VPOKEC+Y,VPEEK(C+Z):NEXT:NEXT:VPOKE8209,&H6F:VPOKE8210,&H6F:VPOKE8211,&H6F:VPOKE8212,&H1F:VPOKE8213,&H1F:VPOKE8214,&H1F:VPOKE8219,&HFF:VPOKE8218,&H4E:RETURN
60000 W$=""
60001 W$=INKEY$:IFW$<>""THENRETURNELSE60001
